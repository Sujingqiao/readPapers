# HMM çš„ EM ç®—æ³•ï¼šå‡½æ•°å¼é€’å½’å®ç°

> **æ•°å­¦å…¬å¼ + Python ä»£ç ä¸€ä½“åŒ–æ–‡æ¡£**  
> æ”¯æŒ GitHub æ¸²æŸ“ï¼Œå¯è¯»ã€å¯å¤åˆ¶ã€å¯è¿è¡Œ

---

## ğŸ¯ ç›®æ ‡

å°† HMM çš„ EM ç®—æ³•ï¼ˆBaum-Welchï¼‰ä»¥ **â€œæ•°å­¦å³å‡½æ•°â€** çš„æ–¹å¼å®ç°ï¼š

- æ¯ä¸ªæ•°å­¦é‡ = ä¸€ä¸ª `@lru_cache` å‡½æ•°
- æ•°å­¦å…¬å¼ä¸ä»£ç ä¸€ä¸€å¯¹åº”
- GitHub å‹å¥½ï¼Œæ”¯æŒå…¬å¼æ¸²æŸ“

---

## ğŸ§© æ¨¡å‹è®¾å®š

- éšçŠ¶æ€æ•°ï¼š$ N $
- è§‚æµ‹ç¬¦å·æ•°ï¼š$ M $
- è§‚æµ‹åºåˆ—ï¼š$ x = (x_1, \dots, x_T) $ï¼Œ$ x_t \in \{0,\dots,M-1\} $
- å‚æ•°ï¼š
  - åˆå§‹æ¦‚ç‡ï¼š$ \pi_i $
  - è½¬ç§»æ¦‚ç‡ï¼š$ a_{ij} $
  - å‘å°„æ¦‚ç‡ï¼š$ b_j(k) $

---

## ğŸ” EM ç®—æ³•ï¼šEæ­¥ä¸Mæ­¥

---

### 1. å‰å‘å˜é‡ $\alpha_t(j)$

**ğŸ“Œ æ•°å­¦å…¬å¼ï¼š**
$$
\alpha_t(j) = 
\begin{cases}
\pi_j b_j(x_1) & t = 1 \\
\left( \sum_{i=1}^N \alpha_{t-1}(i) a_{ij} \right) b_j(x_t) & t > 1
\end{cases}
$$

**ğŸ’» å‡½æ•°å¼å®ç°ï¼š**

```python
@lru_cache(maxsize=None)
def alpha(t, j):
    if t == 1:
        return Ï€[j] * B[j][x[0]]
    else:
        sum_term = sum(alpha(t-1, i) * A[i][j] for i in range(N))
        return sum_term * B[j][x[t-1]]
